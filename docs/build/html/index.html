
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Documentation for Data Analysis: E15190-E14030 &#8212; Data Analysis for E15190-E14030  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Data Analysis for E15190-E14030  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Documentation for Data Analysis: E15190-E14030</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<section id="documentation-for-data-analysis-e15190-e14030">
<h1>Documentation for Data Analysis: E15190-E14030<a class="headerlink" href="#documentation-for-data-analysis-e15190-e14030" title="Permalink to this headline">¶</a></h1>
<section id="useful-links">
<h2>Useful links<a class="headerlink" href="#useful-links" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030">GitHub repository</a></p></li>
<li><p><a class="reference external" href="https://groups.nscl.msu.edu/hira/15190-14030/fanurs/index.html">Plotly: Infographics</a></p></li>
<li><p><a class="reference external" href="https://e15190-runlog.streamlit.app/">Streamlit: Web app</a></p></li>
<li><p><a class="reference external" href="https://htmlpreview.github.io/?https://github.com/fanurs/data-analysis-e15190-e14030/blob/main/database/runlog/downloads/elogs.html">WMU Run log (static only)</a></p></li>
<li><p><a class="reference external" href="https://groups.nscl.msu.edu/hira/15190-14030/index.htm">Experiment homepage (original)</a></p></li>
<li><p><a class="reference internal" href="_autosummary/e15190.html"><span class="doc">API reference</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
</ul>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>All the Python APIs are documented at <a class="reference internal" href="_autosummary/e15190.html"><span class="doc">HERE</span></a>.</p>
<p>C++ source code and standalone scripts are currently not being documented.</p>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>This repository primarily focuses on neutron wall analysis. Instead of starting from the raw event files (binary files from the DAQ), we treat the ROOT files generated using <a class="reference external" href="https://github.com/nscl-hira/E15190-Unified-Analysis-Framework">Daniele’s analysis framework</a> (currently using branch <code class="docutils literal notranslate"><span class="pre">zhu</span></code>) as inputs, and from there we write our own analysis codes. In the case where calibration parameters are not good enough or some minor mistakes were found in the framework, we always try <em>not</em> to modify the framework. Instead, we would like to “freeze” the framework, and correct for any imperfection or errors in the output ROOT files within this repository. Unless there is something that framework does not preserve in the ROOT files, e.g. missing events, then only we will go back and try to debug the framework (currently WMU is working on this).</p>
<p>This decision was made after considering the fact that all major authors of the framework had left the group. It is simply safer and more efficient to keep it as “legacy code”, and build on top of the ROOT files it generated. Fortunately, most of the calibrations have already been done. While some are found to be off later on, most are already good enough for a simple “first-order” analysis.</p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>If you are not familiar with conda, more detailed instructions can be found at <a class="reference internal" href="manualdoc/installation.html#installation-detailed-version"><span class="std std-ref">Installation (detailed version)</span></a>.</p>
<ol class="arabic">
<li><p>Git clone the repository.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone https://github.com/Fanurs/data-analysis-e15190-e14030.git</span>
</pre></div>
</div>
</li>
<li><p>Install (if haven’t) and activate <code class="docutils literal notranslate"><span class="pre">conda</span></code>.</p></li>
<li><p>Build the conda environment. This step is <em>time-consuming</em> (~hours). Use a screen session whenever possible.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd data-analysis-e15190-e14030/</span>
<span class="go">./build.py</span>
</pre></div>
</div>
</li>
<li><p>Activate the conda environment.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">conda activate ./env_e15190/</span>
</pre></div>
</div>
</li>
<li><p>To quickly check if the conda environment has been activated, inspect the environment variable <code class="docutils literal notranslate"><span class="pre">$PROJECT_DIR</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">echo $PROJECT_DIR</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="structure-of-the-repository">
<h2>Structure of the repository<a class="headerlink" href="#structure-of-the-repository" title="Permalink to this headline">¶</a></h2>
<p>This repository is written mainly in Python 3.8 and C++20 (<code class="docutils literal notranslate"><span class="pre">-std=c++2a</span></code> in GCC 9 and earlier).</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/e15190">e15190/</a>: Core Python source codes for doing calibration and analysis</p></li>
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/database">database/</a>: For storing all the calibration parameters, cache files (e.g. <cite>.h5</cite> files), images, ROOT files, Mako templates, etc.</p></li>
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/local">local/</a>: Miscellaneous local configuration files, scripts, etc. C++ source codes also go into here, mainly to separate them from the Python source codes in <a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/e15190">e15190/</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/scripts">scripts/</a>: Here are all the calibration scripts and batch scripts (for parallel computing).</p></li>
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/tests">tests/</a>: Contains all the test scripts.</p></li>
<li><p>env_e15190/: Where the conda environment is built. This directory should not be committed to git. Any custom modifications should be added as symbolic links directing to <a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/local">local/</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/docs">docs/</a>: Documentation of the project. This directory is used to build GitHub Pages for this project (see <a class="reference external" href="https://fanurs.github.io/data-analysis-e15190-e14030/">here</a>, and the files are auto-generated using <a class="reference external" href="https://www.sphinx-doc.org/">Sphinx</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/environment.yml">environment.yml</a>: Configuration file for setting up the conda environment.</p></li>
<li><p><a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/build.py">build.py</a>: Installation script. To build the conda environment as well as modifying a few other things, e.g. environment variables, terminal commands, etc.</p></li>
</ul>
</section>
<section id="testing-framework">
<h2>Testing framework<a class="headerlink" href="#testing-framework" title="Permalink to this headline">¶</a></h2>
<p>We are using the <a class="reference external" href="https://docs.pytest.org/">pytest</a> framework. To test everything, simply activate the conda environment, go to the project directory and type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pytest</span>
</pre></div>
</div>
<p>To test a specify file or directory, e.g. <code class="docutils literal notranslate"><span class="pre">tests/utilities/test_timer.py</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pytest tests/utilities/test_timer.py</span>
</pre></div>
</div>
<section id="when-to-do-unit-testing">
<h3>When to do unit testing?<a class="headerlink" href="#when-to-do-unit-testing" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Right after installation, run all tests to see if things are working correctly.</p></li>
<li><p>After changing any codes, run all tests to check in case things that were previously working are now broken, a.k.a. regression testing. <span class="red">Important!</span></p></li>
<li><p>You are also encouraged to write and run tests <em>while</em> developing the source code. This is often considered as the best practice, though sometimes a little too tedious.</p></li>
<li><p>Any other scenarios where you think there might be a chance to break things, i.e. server updates, conda environment updates, git merge with other collaborators, etc.</p></li>
</ul>
</section>
</section>
<section id="pep-8-style-guide">
<h2>PEP 8 style guide<a class="headerlink" href="#pep-8-style-guide" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8 Style Guide</a> is the most popular style guide among Python developers. It is a set of guidelines for writing Python code that aims to be consistent and readable. The <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">webpage</a> has a detailed description of the style guide. While it is always a good idea to go through the guidelines, not everyone will have the luxury to read the whole document and remember all the rules. So oftentimes, people use some automated tools to format their code.</p>
<p>In this project, we use <a class="reference external" href="https://pypi.org/project/autopep8/">autopep8</a> to automatically format our code in order to comply with the PEP 8 standard. This Python package is already listed in <a class="reference external" href="https://github.com/Fanurs/data-analysis-e15190-e14030/tree/main/environment.yml">environment.yml</a>, so right after you activate the conda environment, you can simply type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">autopep8 demo_script.py --in-place</span>
</pre></div>
</div>
<p>This command should have automatically formatted the <code class="docutils literal notranslate"><span class="pre">demo_script.py</span></code> script in place. In most cases, autopep8 only changes the style of the code, e.g. whitespaces, indentation, etc., and it should not change the behavior of the code. Always re-run some tests if you are not sure.</p>
<p>Lastly, it is strongly recommended to apply autopep8 to your script before committing to git or pushing to GitHub.</p>
</section>
<section id="further-readings">
<h2>Further readings<a class="headerlink" href="#further-readings" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1109/TNS.2021.3091126">Value-Assigned Pulse Shape Discrimination for Neutron Detectors</a> by F. C. E. Teh, et al.</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.nima.2020.163826">Calibration of large neutron detection arrays using cosmic rays</a> by K. Zhu, et al.</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.nima.2019.03.065">Non-linearity effects on the light-output calibration of light charged particles in CsI(Tl) scintillator crystals</a> by D. Dell’Aquila, et al.</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.nima.2021.165798">Reaction losses of charged particles in CsI(Tl) crystals</a> by S. Sweany, et al.</p></li>
<li><p><a class="reference external" href="https://groups.nscl.msu.edu/hira/Publications%20and%20Theses/Thesis_Sean_Sweany.pdf">Doctoral dissertation</a> by Sean Robert Sweany.</p></li>
<li><p><a class="reference external" href="https://groups.nscl.msu.edu/hira/Publications%20and%20Theses/Zhu_dissertation.pdf">Doctoral dissertation</a> by Kuan Zhu.</p></li>
<li><p><a class="reference external" href="https://publications.nscl.msu.edu/thesis/Coupland_2013_338.pdf">Doctoral dissertation</a> by Daniel David Schechtman Coupland.</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Documentation for Data Analysis: E15190-E14030</a><ul>
<li><a class="reference internal" href="#useful-links">Useful links</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#structure-of-the-repository">Structure of the repository</a></li>
<li><a class="reference internal" href="#testing-framework">Testing framework</a><ul>
<li><a class="reference internal" href="#when-to-do-unit-testing">When to do unit testing?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pep-8-style-guide">PEP 8 style guide</a></li>
<li><a class="reference internal" href="#further-readings">Further readings</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">Data Analysis for E15190-E14030  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Documentation for Data Analysis: E15190-E14030</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018-2023, MSU/FRIB HiRA group.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>