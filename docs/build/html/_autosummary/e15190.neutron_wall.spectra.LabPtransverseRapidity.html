
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>e15190.neutron_wall.spectra.LabPtransverseRapidity &#8212; Data Analysis for E15190-E14030  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Data Analysis for E15190-E14030  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">e15190.neutron_wall.spectra.LabPtransverseRapidity</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="e15190-neutron-wall-spectra-labptransverserapidity">
<h1>e15190.neutron_wall.spectra.LabPtransverseRapidity<a class="headerlink" href="#e15190-neutron-wall-spectra-labptransverserapidity" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">e15190.neutron_wall.spectra.</span></span><span class="sig-name descname"><span class="pre">LabPtransverseRapidity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Functions</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.__init__" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(runs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.build_rdataframe" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.build_rdataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_rdataframe</span></code></a>([tree_name, implicit_mt])</p></td>
<td><p>Build the RDataFrame and store it as <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.rdf</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.coverage_curve" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.coverage_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coverage_curve</span></code></a>(rapidity_range)</p></td>
<td><p>Returns a function that calculates the phase space coverage for a given transverse momentum.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.define_energy" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.define_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">define_energy</span></code></a>([name, rdf, inplace])</p></td>
<td><p>Define the total relativistic energy of the neutron.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.define_neutron_cut" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.define_neutron_cut"><code class="xref py py-obj docutils literal notranslate"><span class="pre">define_neutron_cut</span></code></a>([name, light_bias, ...])</p></td>
<td><p>Define the neutron cut, <code class="docutils literal notranslate"><span class="pre">cut</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_charged_particles" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_charged_particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_charged_particles</span></code></a>([rdf, inplace])</p></td>
<td><p>Veto charged particles.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_microball_multiplicity" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_microball_multiplicity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_microball_multiplicity</span></code></a>([bhat_range, ...])</p></td>
<td><p>Filter the RDataFrame by microball multiplicity.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_tdc" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_tdc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_tdc</span></code></a>(tdc_range[, tdc_branch_name, ...])</p></td>
<td><p>Filter the RDataFrame by TDC.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_average_coverages" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_average_coverages"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_average_coverages</span></code></a>(rapidity_range, ...)</p></td>
<td><p>Get average phase space coverages at various transverse momentum ranges.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_coincidence_peak" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_coincidence_peak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coincidence_peak</span></code></a>([branch_name, rdf, ...])</p></td>
<td><p>Get the coincidence peak of the TDC.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_1d" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_1d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_spectrum_1d</span></code></a>(norm_rapidity_range, ...[, ...])</p></td>
<td><p>Get the lab transverse momentum spectrum at a given rapidity range.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_2d" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_spectrum_2d</span></code></a>([norm_rapidity_range, ...])</p></td>
<td><p>Get the 2D histogram of transverse momentum vs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.is_inside" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.is_inside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_inside</span></code></a>(rapidity, transverse_momentum)</p></td>
<td><p>Check if the given points are inside the phase space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curve" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kinergy_curve</span></code></a>(kinergy[, mass])</p></td>
<td><p>Return a function that calculates the transverse momentum for a given rapidity.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curves" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curves"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kinergy_curves</span></code></a>()</p></td>
<td><p>A 2-tuple of kinergy curves that sets the boundaries of the phase space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curve" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta_curve</span></code></a>(theta[, mass])</p></td>
<td><p>Return a function that calculates the transverse momentum for a given rapidity.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curves" title="e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curves"><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta_curves</span></code></a>()</p></td>
<td><p>A 2-tuple of theta curves that sets the boundaries of the phase space.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Properties</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ROOT_FILE_DIR</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bhat_range</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kinergy_range</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta_range</span></code></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.build_rdataframe">
<span class="sig-name descname"><span class="pre">build_rdataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_mt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ROOT.RDataFrame</span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.build_rdataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the RDataFrame and store it as <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.rdf</span></code>.</p>
<p>Different from <a class="reference internal" href="e15190.neutron_wall.spectra.Spectrum.html#e15190.neutron_wall.spectra.Spectrum.build_rdataframe" title="e15190.neutron_wall.spectra.Spectrum.build_rdataframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">Spectrum.build_rdataframe()</span></code></a>, this function will
always build the RDataFrame in place.</p>
<p>This function will apply filters and define new quantities ready for the
construction of transverse momentum spectra. It will also populate the
lazy container with <code class="docutils literal notranslate"><span class="pre">total_count</span></code> and <code class="docutils literal notranslate"><span class="pre">tdc_count</span></code>.</p>
<p>This function is written for quick construction of spectra. Many cuts
and definitions are written with the most common decisions. If you want
to customize the cuts and definitions, you shall use functions in
<a class="reference internal" href="e15190.neutron_wall.spectra.Spectrum.html#e15190.neutron_wall.spectra.Spectrum" title="e15190.neutron_wall.spectra.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a> or directly interact with <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.rdf</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curve">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">theta_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">939.5654205203889</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function that calculates the transverse momentum for a given rapidity.</p>
<p>The theta and mass (particle) are fixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Polar angle in lab frame in radian.</p></li>
<li><p><strong>mass</strong> (<em>float</em><em>, </em><em>default MASS_NEUTRON</em>) – Mass of the particle in MeV/c^2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>transverse_momentum</strong> – Function that calculates the transverse momentum for a given (unnormalized) rapidity in MeV/c.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable[[float | np.ndarray], float | np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curve">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">kinergy_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kinergy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">939.5654205203889</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function that calculates the transverse momentum for a given rapidity.</p>
<p>The kinetic energy and mass (particle) are fixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kinergy</strong> (<em>float</em>) – Kinetic energy in MeV. This should be the total kinetic energy of
the whole isotope (particle). So if you are given the kinetic energy
per nucleon, you should multiply it by the mass number.</p></li>
<li><p><strong>mass</strong> (<em>float</em><em>, </em><em>default MASS_NEUTRON</em>) – Mass of the particle in MeV/c^2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>transverse_momentum</strong> – Function that calculates the transverse momentum for a given rapidity in MeV/c.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable[[float | np.ndarray], float | np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curves">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">theta_curves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Callable</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Callable</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.theta_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>A 2-tuple of theta curves that sets the boundaries of the phase space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>theta_curves</strong> – First element is the curve for the lower boundary, second element is
the curve for the upper boundary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple[Callable, Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curves">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">kinergy_curves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">typing.Callable</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Callable</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.kinergy_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>A 2-tuple of kinergy curves that sets the boundaries of the phase space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>kinergy_curves</strong> – First element is the curve for the lower boundary, second element is
the curve for the upper boundary.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple[Callable, Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.is_inside">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">is_inside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rapidity</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transverse_momentum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.is_inside" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the given points are inside the phase space.</p>
<p>Under the hood, this method converts back both rapidity and transverse
momentum into lab (kinetic) energy and lab theta angle. Then it checks
if the given points are inside the energy cuts and theta cuts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rapidity</strong> (<em>float</em><em> or </em><em>np.ndarray</em>) – The (unnormalized) rapidity in lab frame.</p></li>
<li><p><strong>transverse_momentum</strong> (<em>float</em><em> or </em><em>np.ndarray</em>) – The transverse momentum in MeV/c.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>is_inside</strong> – True if the given points are inside the phase space, False
otherwise. Points on the boundary are considered inside.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool or np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.coverage_curve">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">coverage_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rapidity_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span> <span class="p"><span class="pre">|</span></span> <span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.coverage_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function that calculates the phase space coverage for a given transverse momentum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rapidity_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – The range of unnormalized rapidity in lab frame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coverage</strong> – A function that calculates the coverage of the phase space for a
given transverse momentum in MeV/c.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable[[float | np.ndarray], float | np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_average_coverages">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">get_average_coverages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rapidity_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transverse_momentum_ranges</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_average_coverages" title="Permalink to this definition">¶</a></dt>
<dd><p>Get average phase space coverages at various transverse momentum ranges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rapidity_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – The range of unnormalized rapidity in lab frame.</p></li>
<li><p><strong>transverse_momentum_ranges</strong> (<em>arary of shape</em><em> (</em><em>n</em><em>, </em><em>2</em><em>)</em>) – The transverse momentum ranges in MeV/c.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_2d">
<span class="sig-name descname"><span class="pre">get_spectrum_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm_rapidity_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_rapidity_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptransverse_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">800.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptransverse_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.TH2</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the 2D histogram of transverse momentum vs. beam-normalized rapidity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm_rapidity_range</strong> (<em>2-tuple of float</em><em>, </em><em>default</em><em> (</em><em>0.0</em><em>, </em><em>1.0</em><em>)</em>) – Range of beam-normalized rapidity in lab frame.</p></li>
<li><p><strong>norm_rapidity_bins</strong> (<em>int</em><em>, </em><em>default 200</em>) – Number of bins for the beam-normalized rapidity.</p></li>
<li><p><strong>ptransverse_range</strong> (<em>2-tuple of float</em><em>, </em><em>default</em><em> (</em><em>0.0</em><em>, </em><em>800.0</em><em>)</em>) – Range of transverse momentum in MeV/c.</p></li>
<li><p><strong>ptransverse_bins</strong> (<em>int</em><em>, </em><em>default 800 * 5</em>) – Number of bins for the transverse momentum.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>default True</em>) – When True, the histogram will be stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.lazy</span></code> and
evaluated lazily. When False, the histogram will be evaluated
immediately and returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hist_2d</strong> – The 2D histogram. If <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, returns None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ROOT.TH2 or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_1d">
<span class="sig-name descname"><span class="pre">get_spectrum_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm_rapidity_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptransverse_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptransverse_bins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometric_efficiency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intrinsic_efficiency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_subtraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coverage_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_spectrum_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lab transverse momentum spectrum at a given rapidity range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm_rapidity_range</strong> (<em>2-tuple of float</em>) – Range of beam-normalized rapidity in lab frame.</p></li>
<li><p><strong>ptransverse_range</strong> (<em>2-tuple</em>) – Histogram range of <span class="math notranslate nohighlight">\(p_T/A\)</span> in MeV/c.</p></li>
<li><p><strong>ptransverse_bins</strong> (<em>int</em>) – Number of bins for the histogram.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spectrum</strong> – DataFrame with columns ‘x’, ‘y’, ‘yerr’ and ‘yferr’. If
<code class="docutils literal notranslate"><span class="pre">append_to_lazy=True</span></code>, returns None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame or None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">e15190.neutron_wall</span> <span class="kn">import</span> <span class="n">spectra</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">spectra</span><span class="o">.</span><span class="n">LabPtransverseRapidity</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4224</span><span class="p">,</span> <span class="mi">4245</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">build_rdataframe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">get_spectrum_2d</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># this is needed before you can get 1D spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">get_spectrum_1d</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">norm_rapidity_range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">ptransverse_range</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">ptransverse_bins</span><span class="o">=</span><span class="mi">500</span> <span class="o">//</span> <span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">geometric_efficiency</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intrinsic_efficiency</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_subtraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">coverage_correction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity._drop_spectrum_outliers">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">_drop_spectrum_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_outliers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'y'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity._drop_spectrum_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop outliers in the dataframe.</p>
<p>This function assumes outliers only occur at the ends of the spectrum.
In other words, if a point in the middle is an outlier, it will not be
dropped. This decision is made to keep the resulting spectrum
continuous. Empirically, for this purpose, if an outlier happens in the
middle, it is likely that there is some problem with the data anyway.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – The dataframe to drop outliers from. Must have a column named defined by
<cite>yname</cite>.</p></li>
<li><p><strong>drop_outliers</strong> (<em>float</em>) – Outliers are defined as points whose ratio to the neighboring point is
larger than <cite>drop_outliers</cite>.</p></li>
<li><p><strong>yname</strong> (<em>str</em><em>, </em><em>default 'y'</em>) – The name of the column in <cite>df</cite> that contains the values to check for
outliers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>df</strong> – The dataframe with outliers dropped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity._infer_reaction">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">_infer_reaction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">'target'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'beam'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'beam_energy'</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity._infer_reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer the reaction from the runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runs</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – A list of runs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>reaction</strong> – A dictionary containing the reaction information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict[Literal[‘target’, ‘beam’, ‘beam_energy’], str | float]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the runs are not from the same reaction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity._infer_shadow_bar_present">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">_infer_shadow_bar_present</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity._infer_shadow_bar_present" title="Permalink to this definition">¶</a></dt>
<dd><p>Infer whether the shadow bar is present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runs</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – A list of runs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>presence</strong> – True if the shadow bar is present for all runs, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the runs have different shadow bar presence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.define_energy">
<span class="sig-name descname"><span class="pre">define_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'energy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.define_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the total relativistic energy of the neutron.</p>
<p>This function will define a new column <code class="docutils literal notranslate"><span class="pre">energy</span></code> in the RDataFrame. It
first computes the relativistic beta using time-of-flight and distance
between the target and the hit position on NWB. Then it calculates the
total energy assuming a mass of neutron. If charged particles and gamma
rays have not been excluded, the energies for those hits will be off
because they are not neutrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>default 'energy'</em>) – Name of the new column. The values will be in MeV.</p></li>
<li><p><strong>rdf</strong> (<em>ROOT.RDataFrame</em><em>, </em><em>optional</em>) – The RDataFrame to be filtered. If None, the RDataFrame stored in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">self.rdf</span></code> will be used.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to apply the definition in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rdf</strong> – The RDataFrame with the new column. If <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, returns
None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ROOT.RDataFrame or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.define_neutron_cut">
<span class="sig-name descname"><span class="pre">define_neutron_cut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cut'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">light_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive_adc_cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cuts</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.define_neutron_cut" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the neutron cut, <code class="docutils literal notranslate"><span class="pre">cut</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>default 'cut'</em>) – Name of the new column.</p></li>
<li><p><strong>light_bias</strong> (<em>float</em><em>, </em><em>default 3.0</em>) – The light output bias in MeVee.</p></li>
<li><p><strong>position_cut</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to apply the position cut. Shadow bar cuts are applied
automatically if shadow bars are present in those runs. See <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.shadow_bar_present</span></code>.</p></li>
<li><p><strong>positive_adc_cut</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to apply the positive ADC cut. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all the fast and
total ADCs must be positive.</p></li>
<li><p><strong>extra_cuts</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Extra cuts to be applied. Each cut should be a string that can be
parsed by PyROOT. Any columns that are defined in the RDF can be
used in the cut. The cuts will be joined by <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code>.</p></li>
<li><p><strong>rdf</strong> (<em>ROOT.RDataFrame</em><em>, </em><em>optional</em>) – The RDataFrame to be filtered. If None, the RDataFrame stored in</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to apply the cut in place.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_charged_particles">
<span class="sig-name descname"><span class="pre">filter_charged_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_charged_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Veto charged particles.</p>
<p>This function will filter out charged particles by requiring the
multiplicity of veto wall to be 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdf</strong> (<em>ROOT.RDataFrame</em><em>, </em><em>optional</em>) – The RDataFrame to be filtered. If None, the RDataFrame stored in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">self.rdf</span></code> will be used.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to apply the filter in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rdf</strong> – The filtered RDataFrame. If <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, returns None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ROOT.RDataFrame or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_microball_multiplicity">
<span class="sig-name descname"><span class="pre">filter_microball_multiplicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bhat_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_microball_multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the RDataFrame by microball multiplicity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bhat_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>, </em><em>optional</em>) – The range of normalized impact parameter, e.g. (0.0, 0.4). If this
is not provided, <code class="docutils literal notranslate"><span class="pre">multi_range</span></code> must be provided.</p></li>
<li><p><strong>multi_range</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – The inclusive range of microball multiplicity, e.g. (14, 30). If
<code class="docutils literal notranslate"><span class="pre">bhat_range</span></code> is provided, this will be ignored.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to apply the filter in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rdf</strong> – The filtered RDataFrame. If <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, returns None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ROOT.RDataFrame or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_tdc">
<span class="sig-name descname"><span class="pre">filter_tdc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tdc_range</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdc_branch_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TDC_mb_nw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">cppyy.gbl.ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.filter_tdc" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the RDataFrame by TDC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tdc_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – The range of TDC.</p></li>
<li><p><strong>rdf</strong> (<em>ROOT.RDataFrame</em><em>, </em><em>optional</em>) – The RDataFrame to be filtered. If None, the RDataFrame stored in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">self.rdf</span></code> will be used.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to apply the filter in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rdf</strong> – The filtered RDataFrame. If <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, returns None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ROOT.RDataFrame or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="e15190.neutron_wall.spectra.LabPtransverseRapidity.get_coincidence_peak">
<span class="sig-name descname"><span class="pre">get_coincidence_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TDC_mb_nw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ROOT.RDataFrame</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_histogram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">'mean'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'stdev'</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span> <span class="p"><span class="pre">|</span></span> <span class="pre">ROOT.TH1</span></span></span><a class="headerlink" href="#e15190.neutron_wall.spectra.LabPtransverseRapidity.get_coincidence_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the coincidence peak of the TDC.</p>
<p>You may want to apply the microball multiplicity filter before calling
this function.</p>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Data Analysis for E15190-E14030  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">e15190.neutron_wall.spectra.LabPtransverseRapidity</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018-2023, MSU/FRIB HiRA group.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>